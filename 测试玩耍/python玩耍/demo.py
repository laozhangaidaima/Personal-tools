from __future__ import unicode_literals
import time
from wxpy import *
import requests
import re
qhdqs = []  # å»ºä¸€ä¸ªç©ºåˆ—è¡¨è£…ç½‘ä¸Šçš„æƒ…è¯
# for i in range(1000, 3000):
for i in range(1000, 1005):
    print("i", i)
    try:
        url = "http://www.ainicr.cn/qh/" + str(i) + ".html"
        print("url", url)

        # æ‰¾åˆ°ä¸€ä¸ªæƒ…è¯ç½‘ç«™ï¼Œç½‘ç«™è§„å¾‹å¾ˆç®€å•ï¼Œä»1000å¼€å§‹ï¼Œæ¯é¡µå¤§æ¦‚10å¥ï¼Œ2000é¡µçš„è¯æ˜¯20000å¥æƒ…è¯
        # åº”è¯¥å¤Ÿå¬äº†å§
        response = requests.get(url).text  # ç”¨requests.getï¼ˆï¼‰å‡½æ•°è®¿é—®é¡µé¢å¹¶è·å¾—ä¿¡æ¯
        counts = re.findall('<p>(.*?)</p></a>', response)
        # ç”¨æ­£åˆ™è¡¨è¾¾å¼æå–ä¿¡æ¯
        # ç½‘ç«™ç¨‹åºå‘˜ä¼°è®¡å¿™ç€è°ˆæ‹çˆ±å»äº†ï¼Œå¤ªå®¹æ˜“æŠ“å–å’Œæ¸…æ´—äº†
        # ä¸è¿‡ä¹Ÿè®¸æ˜¯ä¸ºäº†å¸®åŠ©å¹¿å¤§ç¨‹åºå‘˜çˆ¬å–æƒ…è¯çˆ±å“„å¥³æœ‹å‹
        for count in counts:  # ä¾æ¬¡è·å–æƒ…è¯
            qhdqs.append(count)  # æŠŠæƒ…è¯æ·»åŠ åˆ°æƒ…è¯å¤§å…¨ä¸­
    except:
        print("é”™è¯¯")

        pass  # å‡ºé”™çš„è¯å°±è·³è¿‡ï¼Œä¸¤ä¸‡å¥æƒ…è¯ï¼Œå°‘ä¸ªç™¾åæ¡ä¸é‡è¦


bot = Bot()  # å¼€å§‹è¿›è¡Œç½‘é¡µå¾®ä¿¡ç™»é™†
try:
    # my_friend = bot.friends().search(u'å¾®ä¿¡åç§°')[0]  # ä½ å¥³æœ‹å‹çš„å¾®ä¿¡åç§°ï¼Œä¸æ˜¯å¤‡æ³¨ï¼Œä¹Ÿä¸æ˜¯å¾®ä¿¡å¸å·ã€‚
    my_friend = bot.friends().search(u'å˜¿ä½ è®¤çœŸç‚¹ğŸ™„')[0]  # ä½ å¥³æœ‹å‹çš„å¾®ä¿¡åç§°ï¼Œä¸æ˜¯å¤‡æ³¨ï¼Œä¹Ÿä¸æ˜¯å¾®ä¿¡å¸å·ã€‚
    for qh in qhdqs:  # ä»æƒ…è¯å¤§å…¨ä¸­æå–æƒ…è¯
        my_friend.send(qh)  # ç»™å¥³æœ‹å‹å‘æƒ…è¯
        time.sleep(3)  # ä¼‘æ¯3ç§’é’Ÿè®©å¥³æœ‹å‹æœ‰æ—¶é—´çœ‹ä¸€ä¸‹ï¼Œè¦ä¸ç„¶ä¸å°±ç™½åšäº†
except:
    my_friend = bot.friends().search('ä½ çš„å¾®ä¿¡åç§°')[0]  # ä½ çš„å¾®ä¿¡åç§°ï¼Œä¸æ˜¯å¾®ä¿¡å¸å·ã€‚
    my_friend.send(u"æ¶ˆæ¯å‘é€å¤±è´¥äº†")  # å‘Šè¯‰è‡ªå·±æ¶ˆæ¯å‘é€å¤±è´¥ï¼Œç™¾åæ¡å¤±è´¥çš„è¯ä¸ç”¨å¤„ç†ï¼Œåæ­£æƒ…è¯å¤š
